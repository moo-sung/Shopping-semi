<%@page import="dao.ProductDAO"%>
<%@page import="dto.ProductDTO"%>
<%@page import="dao.OrdersDAO"%>
<%@page import="dto.OrdersDTO"%>
<%@page import="java.util.List"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@include file="/security/login_check.jspf"%>
<%
	List<OrdersDTO> orderList= OrdersDAO.getDAO().selectAllOrdersList(loginMember.getEmail());
	
	String idx= request.getParameter("id");
%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>nookyoon</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="<%=request.getContextPath() %>/css/common.css"> 
<link rel="icon" href="<%=request.getContextPath()%>/images/favicon.ico">
<style type="text/css">
#oderList {
	text-align: center;
	margin: 0 auto;
	width: 1200px;
}
#orderList .orderTable .tableTitle {
	min-width: 200px;
	max-width : 800px;
	margin: 0 auto;
}
#orderList .orderTable .tableTitle h3 {
	text-align: left;
	margin-bottom: 20px;
	padding-left: 12px;
	font: 15px bold;
}

#orderList .orderTable table {
	margin: 0 auto;
	min-width: 200px;
	max-width : 1000px;
}

#orderList .orderTable {
	text-align: center;
}

</style>
</head>
<body>
  <div id="wrap">
	<%-- header 불러오기 --%>
	<jsp:include page="../form/header.jsp"/>
    <%-- side 불러오기 --%>
    <jsp:include page="../form/side.jsp"/>
    <!-- container start -->  
    <div id="container">
	   <!-- content area => 안에 내용들 다 지우고본문작성 -->
      <div id="content">   
        <div class="main"> 
        	<div class="titleArea">
        		<h1>Order List</h1>
        		<br>
         	</div> 
         	<div id="orderList">
         		<div class="orderTable">
         			<div class="tableTitle">
	         			<h3>주문 상품 정보</h3>
	         		</div>
	         		<table border="1" summary="">
	         			<caption style="display: none">주문 상품 정보</caption>
	         			<colgroup>
	         				<col style="width: 80px;">
	         				<col style="width: auto;">
	         				<col style="width: 111px;">
	         				<col style="width: 111px;">
	         				<col style="width: 111px;">
	         				<col style="width: 111px;">
	         				<col style="width: 111px;">
	         			</colgroup>
	         			<thead>
	         				<tr>
	         					<th scope="col" style="padding: 10px 0;">주문번호</th>
	         					<th scope="col">주문자</th>
	         					<th scope="col">배송지(별칭)</th>
	         					<th scope="col">주문일자</th>
	         					<th scope="col">주문확인</th>
	         					<th scope="col">배송확인</th>
	         					<th scope="col">도착확인</th>
	         				</tr>
	         			</thead>
	         			<tbody>

	      				<% if(orderList.isEmpty()) { %>
							<tr>
								<td colspan="7"> 주문 내역이 없습니다.</td>
							</tr>		      					
	      				<% } else { %>
	      					<% int i= 0;
	      					for(; i<orderList.size(); i++) {
	      					%>
	      					<tr>
	      						<td style="padding: 10px 0;">
	      							<%-- <input type="text" id="order_id<%=i%>"
	      							name="order_id<%=i%>" readonly="readonly"
	      							value="<%=orderList.get(i).getIdx()%>" style="width: 60px; border: none; text-align: center;" onclick="load()"> --%>
	      							<a href="orderList_detail.jsp?name=<%=orderList.get(i).getIdx()%>" id="order_id<%=i%>"
	      							style="width: 80px; border: none; text-align: center;" 
	      							onclick="window.open(this.href, '주문조회', 'width=400, height=400'); return false;">
	      							<%=orderList.get(i).getIdx()%>
	      							</a>
	      						</td>
	      						<td id="idx<%=i%>"><%=orderList.get(i).getEmail()%></td>
	      						<td id="address_id<%=i%>"><%=orderList.get(i).getAddress_id()%></td>
	      						<td id="order_date<%=i%>"><%=orderList.get(i).getOrder_date().substring(0, 10)%></td>
	      						<td id="namePay<%=i%>">
	      							<input type="text" id="pay<%=i%>" value="<%=orderList.get(i).getPay_confirm()%>">
	      						</td>
	      						<td id="nameDeli<%=i%>">
	      							<input type="text" id="deli<%=i%>" value="<%=orderList.get(i).getDelivery_confirm()%>">
	      						</td>	      					
	      						<td id="nameArrive<%=i%>">
	      							<input type="text" id="arrive<%=i%>" value="<%=orderList.get(i).getArrive_confirm()%>">
	      						</td>
	      					</tr>
	      					<% } %>
	      				<% } %>	
	      				
	         			</tbody>
	         		</table>
         		</div>     	
         	</div> 
        </div>
      </div>
    </div>
    <!-- container end -->
	<form action="<%=request.getContextPath()%>/wontack/review_write.jsp">
		<input type="text" name="productIdx" value="<%=idx%>">
	</form>
	
	<%-- footer 불러오기 --%>
	<jsp:include page="../form/footer.jsp"/>
  </div>
</body>

<script type="text/javascript">
 	var i= 0;
	 for(; i<<%=orderList.size()%>;i++){
		if(document.getElementById("pay"+i).getAttribute("value")=="0") {
			document.getElementById("namePay"+i).innerHTML="X";
		} else if(document.getElementById("pay"+i).getAttribute("value")=="1") {
			document.getElementById("namePay"+i).innerHTML="O";
		}
		
		if(document.getElementById("deli"+i).getAttribute("value")=="0") {
			document.getElementById("nameDeli"+i).innerHTML="X";
		} else if(document.getElementById("deli"+i).getAttribute("value")=="1") {
			document.getElementById("nameDeli"+i).innerHTML="O";
		}
		if(document.getElementById("arrive"+i).getAttribute("value")=="0") {
			document.getElementById("nameArrive"+i).innerHTML="X";
		} else if(document.getElementById("arrive"+i).getAttribute("value")=="1") {
			document.getElementById("nameArrive"+i).innerHTML="O";
		}
		
		if(document.getElementById("address_id"+i).value=="null") {
			document.getElementById("address_id"+i).innerHTML="";
		}
	}
	 
	 
	
</script>
</html>