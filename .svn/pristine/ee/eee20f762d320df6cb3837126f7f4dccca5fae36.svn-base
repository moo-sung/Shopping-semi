<%@page import="dao.ProductDAO"%>
<%@page import="dto.ProductDTO"%>
<%@page import="java.util.List"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%
	List<ProductDTO> productList=ProductDAO.getDAO().selectAllProductList("released_date");

String[] imgMain = new String[productList.size()];

for(int i=0;i<productList.size();i++){
	String image = productList.get(i).getImg_source();
	imgMain[i] = image.split(",")[0];
}
%>
<!DOCTYPE html>
<html>
<head>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<meta charset="UTF-8">
<title>관리자</title>
<link rel="stylesheet"
	href="<%=request.getContextPath()%>/css/common.css">
<link rel="icon" href="<%=request.getContextPath()%>/images/favicon.ico">
<style type="text/css">
/* CSS 작성 */
#wrap {
   width: 100;
   margin: 0 auto;      
}

#container {
   width: 1000px;
   margin: 0 auto;      
}

#container {
   /* 글 정렬 */
   text-align: center;
}

h1 {
	text-align: center;
}

table {
	margin: 5px auto;
	border: 0.5px solid rgb(207, 207, 207);
	width: auto;
	border-collapse: collapse;
}

th, td {
	padding: 11px 10px 10px;
	height: 30px;
	border: 0.5px solid rgb(207, 207, 207);
	text-align: center;
}

.productF input {
	font-size: 18px;
	border: none;
	padding-left: 1px;
	line-height: 20px;
	min-width: 300px;
	border-bottom: 1px solid white;
}

.productF input:focus {
	outline: none;
}


#searchP {
	width: 500px;
	margin: 0 auto;
	padding-top: 15px;
	text-align: center;
}

#searchBtnP {
	margin: 0 auto;
	background-color: rgb(207, 207, 207);
	cursor: pointer;
	padding: 5px 5px;
	color: rgb(13, 13, 13);
	font-size: 15px;
	font-family: 'Montserrat', sans-serif;
}

#searchBtnP:hover {
	background-color: rgb(13, 13, 13);
	color: rgb(207, 207, 207);
	border: 1px solid rgb(207, 207, 207);
}

.add {
	width: 500px;
	margin: 0 auto;
	text-align: center;
}

#reBtn, #addBtn {
	margin: 0 auto;
	background-color: rgb(207, 207, 207);
	cursor: pointer;
	padding: 5px 50px;
	color: rgb(13, 13, 13);
	font-size: 15px;
	font-family: 'Montserrat', sans-serif;
}

#reBtn:hover, #addBtn:hover {
	background-color: rgb(13, 13, 13);
	color: rgb(207, 207, 207);
	border: 1px solid rgb(207, 207, 207);
}

</style>
</head>
<body>
	<div id="wrap">
		<%-- side 불러오기 --%>
		<jsp:include page="/admin/admin_side.jsp" />
		<!-- container start -->
		<div id="container">
			<!-- content area => 본문작성 -->
			<div id="content">
				<div class="controlArea">
					<h1>제품관리</h1>
				</div>
				<br>
				<div id="searchP">
					<form method="post" name="pForm" class="productF">
						<select name="searchP">
							<option value="name" selected="selected">제품명</option>
							<option value="idx" selected="selected">제품코드</option>
							<option value="kinds" selected="selected">카테고리</option>
						</select>
						<input type="text" name="product">
						<a type="button" id="searchBtnP" >조회</a>
					</form>
				</div>
				<br>
				<div class="add">
					<button type="button" id="addBtn">추가</button>
				</div>
				<div class="prodeculist">
					<form name="productForm" id="productForm">
						<table>
							<tr>
								<th>제품코드</th>
								<th>제품명</th>
								<th>이미지</th>
								<th>가격</th>
								<th>카테고리</th>
								<th>수량</th>
								<th>등록일</th>
								<th>제품상태</th>
								<th>삭제</th>
							</tr>
							
								<% int i=0;
									for(; i<productList.size(); i++) { %>
							<tr>
								<th class="product_c"><%=productList.get(i).getIdx() %></th>
								<th class="product_n"><%=productList.get(i).getName() %></th>
								<th class="product_i">
									<img src="<%=request.getContextPath()%>/images/<%=imgMain[i]%>" width="50" height="50"></th>
								<th class="product_p"><%=productList.get(i).getPrice() %></th>
								<th class="product_s"><%=productList.get(i).getKinds() %></th>
								<th class="product_s"><%=productList.get(i).getStock()%></th>
								<th><%=productList.get(i).getRelease_date() %></th>
								<td class="product_status">
									<select class="status" name="<%=productList.get(i).getIdx()%>">
										<option value="NEW" <% if(productList.get(i).getNew_best()=="NEW") { %> selected <% } %>>NEW</option>
										<option value="BEST" <% if(productList.get(i).getNew_best()=="BEST") { %> selected <% } %>>BEST</option>
										<option value="NEW_BEST" <% if(productList.get(i).getNew_best()=="NEW_BEST") { %> selected <% } %>>NEW_BEST</option>
									</select>
								</td>
								<th id="delete" class="delete" onclick="deleteProduct(<%=i%>)">삭제</th>
							</tr>
							<% } %>
						</table>
					</form>
				</div>
			</div>
		</div>
	</div>
	<script type="text/javascript">
	document.getElementById("searchBtnP").onclick=function() {
		if(pForm.product.value=="") {
			alert("제품명을 입력해주세요.");
			return;
		} else {			
			window.open("<%=request.getContextPath()%>/admin/searchP_action.jsp","제품조회"
			    ,"height=550, width=1100");
		}
		pForm.submit();
	}
	
	document.getElementById("addBtn").onclick=function() {
		window.open("<%=request.getContextPath()%>/admin/product_add.jsp","제품추가"
				,"height=700, width=470");
	}
	
	

	</script>
</body>
</html>